{% extends "_layouts/base.twig" %}
{% import "_macros" as macros %}

{% block title %}
	{{ entry.title }}- {{ siteName }}
{% endblock %}

{% block content %}
	<article class="experience">
		{% if entry.experienceType == "editorialReportage" %}
			{% if entry.featuredImage|length %}
				{% include "_modules/page-header" with {
					image: entry.featuredImage.one(),
					sectionWidth: "full",
					imageHeight: "full",
					layout: "layout-full"
				} only %}
			{% endif %}
		{% else %}
			<section class="bg-accent/30 dark:bg-accent/60">
				<blockquote
					class="container-wide flex min-h-[100vw] flex-col items-center justify-center p-1 text-3xl font-extralight italic md:min-h-[50vh] md:items-start md:p-6 md:text-4xl 2xl:p-6 2xl:text-5xl/8"
				>
					<p class="max-w-2xl text-center md:text-left lg:max-w-3/5">
						<span class="mr-1 inline-block font-medium">“</span>{{ entry.shortQuote }}<span
							class="-mr-2 inline-block font-medium"
						>
							”
						</span>
					</p>
					{% if entry.peopleInvolved|length %}
						<footer class="mt-4 2xl:mt-6">
							{% for person in entry.peopleInvolved.all()|filter(p => p.showInPreview) %}
								<div class="flex items-center gap-3">
									{% if person.involvedPersonPhoto|length %}
										{% set photo = person.involvedPersonPhoto.one() %}
										<img
											src="{{
											photo.getUrl({
												width: 160,
												height: 160,
												mode: "crop"
											})
											}}"
											srcset="{{ macros.srcSet(photo, true, "1:1") }}"
											sizes="80px"
											alt="{{ person.involvedPersonName }}"
											class="h-10 w-10 rounded-full object-cover lg:h-14 lg:w-14"
										/>
									{% endif %}
									<div class="text-base text-gray-700 not-italic md:text-lg dark:text-gray-300">
										<span class="block font-semibold">{{ person.involvedPersonName }}</span>
										<span class="font-light">{{ person.involvedPersonRole }}</span>
									</div>
								</div>
							{% endfor %}
						</footer>
					{% endif %}
				</blockquote>
			</section>
		{% endif %}
		<div class="mb-5 bg-accent/10 py-8 dark:bg-accent/5">
			<header class="mx-auto max-w-(--max-width)">
				<div class="hero-text px-1 md:px-4 2xl:max-w-1/2">
					{% if entry.title is defined %}
						<h1 class="mb-2 text-2xl/4 font-light text-gray-900 md:text-3xl/5 2xl:text-4xl/6 dark:text-gray-200">
							{{ entry.title|striptags("<strong><em>")|raw }}
						</h1>
					{% endif %}
					{% if entry.shortQuote is defined %}
						<p class="text-base font-medium md:text-xl">
							{{ entry.shortQuote|striptags("<strong><em>")|raw }}
						</p>
					{% endif %}
				</div>
			</header>
			<section class="project-meta container-wide mt-2 mb-0 pt-0 text-base md:mt-6 2xl:text-lg">
				<span><strong>{{ entry.experienceType.label }}</strong> -</span>
				{% set place = entry.place.one() %}
				{% if place %}
					<span><strong>{{ place.title }}</strong>, {{ place.city }}</span>
				{% endif %}
				{% if entry.dateOfExperience %}
					<time datetime="{{ entry.dateOfExperience|date("Y-m") }}" class="before:content-['-']">
						{{ entry.dateOfExperience|date("F Y") }}
					</time>
				{% endif %}
				{% set themes = entry.themes.all() %}
				<nav aria-label="Experience themes" class="mt-4 flex flex-wrap items-center">
					<span class="mb-1 text-base text-gray-500 dark:text-gray-300">Themes:</span>
					<ul class="flex w-full flex-wrap gap-2">
						{% for theme in themes %}
							<li>
								{% include "_modules/link-text" with {
									url: theme.url,
									label: theme.title,
									additionalClasses: "font-bold text-base 2xl:text-lg"
								} only %}
							</li>
						{% endfor %}
					</ul>
				</nav>
			</section>
		</div>
		{# Body Content - Matrix Blocks #}
		{% for block in entry.body.all() %}
			{% switch block.type %}
				{% case "richText" %}
					{% include "_partials/_experience-blocks/rich-text" with {
						block
					} only %}
				{% case "pullQuote" %}
					{% include "_partials/_experience-blocks/pull-quote" with {
						block
					} only %}
				{% case "imageBlock" %}
					{% include "_partials/_experience-blocks/image-block" with {
						block
					} only %}
				{% case "callout" %}
					{% include "_partials/_experience-blocks/callout" with {
						block
					} only %}
				{% case "beforeAfter" %}
					{% include "_partials/_experience-blocks/before-after" with {
						block
					} only %}
				{% default %}
					<p class="text-red-500">
						Unknown block type: {{ block.type }}
					</p>
			{% endswitch %}
		{% endfor %}
		{# People Involved #}
		{% if entry.peopleInvolved|length %}
			<section class="people-involved">
				<div class="container-wide">
					<h3 class="text-lg font-light md:text-2xl">People Involved</h3>
				</div>
				<div class="container-full mb-8 bg-accent/10 p-4 py-8 md:p-8 2xl:p-8 dark:bg-accent/5">
					<div class="container-wide-- grid grid-cols-1 gap-12 md:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4">
						{% for person in entry.peopleInvolved.all() %}
							<div class="person-card">
								{% if person.involvedPersonPhoto|length %}
									{% set photo = person.involvedPersonPhoto.one() %}
									<img
										src="{{
										photo.getUrl({
											width: 160,
											height: 160,
											mode: "crop"
										})
										}}"
										srcset="{{ macros.srcSet(photo, true, "1:1") }}"
										sizes="80px"
										alt="{{ person.involvedPersonName }}"
										class="mb-3 h-20 w-20 rounded-full object-cover"
									/>
								{% endif %}
								<h3 class="mb-1 text-xl font-light">{{ person.involvedPersonName }}</h3>
								<p class="mb-2 text-base font-medium">
									{{ person.involvedPersonRole }}
								</p>
								{% if person.text %}
									<p class="text-base">
										{{ person.text }}
									</p>
								{% endif %}
								{% if person.caption %}
									<small class="mt-2 inline-block text-sm text-gray-500 dark:text-gray-300">{{ person.caption }}</small>
								{% endif %}
							</div>
						{% endfor %}
					</div>
				</div>
			</section>
		{% endif %}
	</article>
{% endblock %}
